import React, {Component} from "react";
import styled from "styled-components";
import SearchForm from "../SearchForm/SearchForm";
import Router from "next/router";
import SearchModal from "../JobSearch/SearchModal";
import logEvent from "../../lib/logEvent";
import config from '../config/styleConsts'
import styles from "./header.module.css";

const {mobileMaxWidth} = config

const HeaderDiv = styled.div`
    background: linear-gradient(169.81deg, #5c6ac4 0%, #202e78 100%);
    min-height: 70px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    box-sizing: border-box;
    position: fixed;
    z-index: 9999;
    top: 0;
    left: 0;
    right: 0;
    max-width: 100vw;
    box-shadow: 0px 1px 4px rgba(77, 77, 77, 0.24);
    @media (max-width: ${mobileMaxWidth}) {
        padding: 12px 8px;
        min-height: 52px;
    }
`;

const LogoDiv = styled.div`
  cursor: pointer;
  align-items: center;
  display: flex;
  img + img {
    margin-left: 4px;
  }

`;

const ActionDivMobile = styled.div`
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
`;

const Logo = styled.img`
  @media (max-width: ${mobileMaxWidth}) {
    height: 24px;
    width: 24px;
  }
`;

const LogoText = styled.img`
  @media (max-width: ${mobileMaxWidth}) {
    height: 22px;
    width: 100px;
  }
`;

const Button = styled.button`
  min-height: 47px;
  border-radius: 5px;
  border: 2px solid #ffffff;
  background: none;
  padding: 0px 20px;
  align-items: center;
  color: white;
  box-sizing: border-box;
  font-weight: bold;
  font-size: 16px;
  line-height: 19px;
  display: flex;
  align-items: center;
  cursor: pointer;
  justify-content: center;
  @media (max-width: ${mobileMaxWidth}) {
    /* width: 133px; */
    min-height: 36px;
    padding: 0px 14px;
  }
`;

const ButtonIcon = styled.img`
  margin-right: 6px;
  width: 18px;
  height: 18px;
`;

class Header extends React.Component {
    constructor(props) {
        super(props);
        this.state = {
            modalIsOpen: false
        };
    }

    OpenModalSearch() {
        this.setState({modalIsOpen: true});
    }


    componentDidMount() {

        let self = this;

        this.props.app.OpenModalSearch = function (origin) {

            self.setState({modalIsOpen: true});

            logEvent("click-open_search", {
                origin: origin || "search_modal"
            });

        };

    }


    render() {
        const {
            buttonTitle,
            openModalSearch,
            logo,
            onSubmit,
            setKeyword,
            getKeyword,
            keyword,
            origin,
            getLocation,
            app
        } = this.props;
        return (
            <React.Fragment>
                <HeaderDiv>
                    <LogoDiv
                        onClick={() => {
                            logEvent("click-logo", {origin: origin});
                            Router.push("/");
                        }}
                    >
                        <div className={styles.headerLogo}>
                            <svg
                                xmlns="http://www.w3.org/2000/svg"

                                viewBox="0 0 38 38"
                            >
                                <defs>
                                    <linearGradient
                                        id="linearGradient-1"
                                        x1="50.027%"
                                        x2="50.027%"
                                        y1="14.4%"
                                        y2="106.629%"
                                    >
                                        <stop offset="0%" stopColor="#C4CDD5"></stop>
                                        <stop offset="100%" stopColor="#F9FAFB"></stop>
                                    </linearGradient>
                                </defs>
                                <g fill="none" fillRule="evenodd" stroke="none" strokeWidth="1">
                                    <g>
                                        <path
                                            fill="#FFF"
                                            d="M38 19c0 10.493-8.507 19-19 19S0 29.493 0 19c0-3.057.722-5.946 2.005-8.505a5.09 5.09 0 116.797-7.53A18.91 18.91 0 0119 0a18.91 18.91 0 0110.198 2.966 5.09 5.09 0 116.797 7.53A18.921 18.921 0 0138 19z"
                                        ></path>
                                        <path
                                            fill="url(#linearGradient-1)"
                                            fillRule="nonzero"
                                            d="M19.014 31.124c-4.715 0-9.03-3.496-9.03-8.455v-3.174c0-2.062.803-4 2.263-5.46l4.066-4.061a3.828 3.828 0 015.403 0l4.065 4.062a7.667 7.667 0 012.264 5.46v3.173c0 4.95-4.31 8.455-9.03 8.455z"
                                        ></path>
                                        <path
                                            fill="#212B36"
                                            fillRule="nonzero"
                                            d="M19.012 25.858c-2.359 0-4.278-1.719-4.278-3.831s1.92-3.83 4.278-3.83c2.359 0 4.278 1.718 4.278 3.83s-1.92 3.83-4.278 3.83zM10.014 11.526c.665 0 1.205-.543 1.205-1.214 0-.67-.54-1.213-1.205-1.213s-1.204.543-1.204 1.213.539 1.214 1.204 1.214zM28.076 11.525c.665 0 1.204-.543 1.204-1.214 0-.67-.54-1.213-1.204-1.213-.666 0-1.205.543-1.205 1.213s.54 1.214 1.205 1.214z"
                                        ></path>
                                    </g>
                                </g>
                            </svg>
                        </div>

                        <div className={styles.headerLogoText}>
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="100"
                                height="20"
                                fill="none"
                                viewBox="0 0 98 18"
                            >
                                <path
                                    fill="#fff"
                                    d="M6.323 2.573a.43.43 0 01.052-.23.38.38 0 01.115-.135.32.32 0 01.125-.052.845.845 0 01.104-.01h2.916c.202 0 .337.038.407.114.076.07.114.205.114.407l-.062 10.052a5.146 5.146 0 01-.23 1.52 4.13 4.13 0 01-.604 1.198c-.25.34-.541.632-.875.876a4.994 4.994 0 01-1.062.593c-.368.153-.75.264-1.146.334a6.044 6.044 0 01-1.146.114c-.694 0-1.309-.09-1.843-.27-.528-.181-.99-.41-1.386-.688a4.493 4.493 0 01-.969-.948 5.965 5.965 0 01-.614-1.01 1.512 1.512 0 01-.136-.448c-.02-.16.049-.282.209-.365l2.062-1.094c.18-.097.327-.132.438-.104.11.02.222.136.333.344.07.132.163.26.281.385a2.405 2.405 0 00.854.573c.167.056.334.083.5.083.466 0 .84-.114 1.125-.343.292-.236.438-.598.438-1.084V2.573zm5.858 6.885c0-.77.142-1.49.427-2.156a5.62 5.62 0 011.188-1.76 5.57 5.57 0 011.78-1.177 5.637 5.637 0 012.199-.428c.791 0 1.531.143 2.219.428a5.542 5.542 0 011.791 1.177c.507.5.903 1.086 1.188 1.76.291.667.437 1.386.437 2.156v2.396c0 .764-.146 1.483-.437 2.156a5.427 5.427 0 01-1.188 1.75 5.63 5.63 0 01-1.791 1.167 5.664 5.664 0 01-2.209.427 5.665 5.665 0 01-3.99-1.594c-.5-.5-.895-1.083-1.187-1.75a5.48 5.48 0 01-.427-2.156V9.458zm3.708 2.48c0 .284.046.552.136.802.097.243.229.454.396.635.166.18.368.323.604.427.236.097.496.146.781.146.285 0 .545-.052.781-.156.236-.104.438-.243.604-.417.167-.18.296-.392.386-.635.097-.244.146-.507.146-.792V9.344c0-.285-.049-.549-.146-.792a1.902 1.902 0 00-.386-.635 1.8 1.8 0 00-.604-.427 1.914 1.914 0 00-.781-.157c-.285 0-.545.052-.781.157a1.799 1.799 0 00-.604.427c-.167.18-.299.392-.396.635-.09.243-.136.507-.136.792v2.594zm21.037-.084c0 .764-.132 1.483-.396 2.156a5.524 5.524 0 01-1.094 1.75 5.143 5.143 0 01-1.646 1.167 4.938 4.938 0 01-2.052.427c-.312 0-.604-.048-.875-.146a3.291 3.291 0 01-.77-.375 3.989 3.989 0 01-.657-.583 6.545 6.545 0 01-.541-.74l-.209 1.021a.609.609 0 01-.208.354.6.6 0 01-.365.115h-1.958a.474.474 0 01-.333-.115c-.084-.076-.125-.194-.125-.354V.99c0-.16.041-.278.125-.355a.474.474 0 01.333-.114h2.604c.16 0 .302.038.427.114.132.07.198.184.198.344v4.23c.313-.376.663-.681 1.052-.917a2.479 2.479 0 011.313-.354c.736 0 1.416.142 2.041.427.632.284 1.18.677 1.646 1.177.465.5.83 1.086 1.094 1.76.264.667.396 1.386.396 2.156v2.396zm-3.709-2.51c0-.285-.045-.549-.135-.792a1.9 1.9 0 00-.385-.635c-.16-.18-.351-.323-.573-.427a1.672 1.672 0 00-.72-.157 2.007 2.007 0 00-1.438.583 2.006 2.006 0 00-.582 1.428v2.687c.007.271.063.525.167.76.11.23.257.431.437.605.18.173.39.309.625.406.243.097.507.146.792.146.257 0 .496-.049.719-.146.222-.104.413-.246.573-.427a1.9 1.9 0 00.385-.635c.09-.25.135-.518.135-.803V9.345zm5.068 5.219a.87.87 0 01-.135-.396c-.007-.125.09-.247.291-.365l2.198-1.146c.209-.118.39-.048.542.209a2.698 2.698 0 00.802.833c.174.111.358.201.552.27.202.063.41.095.625.095.368 0 .674-.06.917-.178.25-.125.375-.312.375-.562 0-.16-.077-.302-.23-.427a2.208 2.208 0 00-.604-.365 7.967 7.967 0 00-.875-.344c-.326-.118-.666-.243-1.02-.374a9.53 9.53 0 01-1.386-.626 4.46 4.46 0 01-1.031-.791 3.298 3.298 0 01-.656-1.031c-.146-.39-.219-.84-.219-1.355 0-.541.115-1.055.344-1.541.236-.493.559-.924.968-1.292.417-.375.91-.674 1.48-.896a5.056 5.056 0 011.854-.333c.535 0 1.045.083 1.531.25a5.71 5.71 0 011.323.646c.396.257.736.545 1.02.864.292.313.508.618.647.917.034.076.062.146.083.208.02.056.028.108.02.157a.238.238 0 01-.072.135.697.697 0 01-.198.125l-1.98.927c-.152.076-.27.108-.353.094-.077-.021-.157-.094-.24-.219a1.825 1.825 0 00-.698-.594 2.072 2.072 0 00-.958-.218c-.368 0-.656.059-.865.177-.201.11-.302.264-.302.458 0 .139.056.257.167.354.118.09.288.18.51.271.23.09.514.191.854.302.348.111.75.25 1.209.417.583.215 1.08.469 1.49.76.416.292.756.611 1.02.959.264.347.459.718.584 1.114.124.396.187.806.187 1.23 0 .631-.135 1.2-.406 1.708a4.02 4.02 0 01-1.063 1.28 4.947 4.947 0 01-1.531.803 5.755 5.755 0 01-1.792.281c-.451 0-.91-.052-1.375-.156a5.752 5.752 0 01-1.354-.49 6.125 6.125 0 01-1.24-.864 5.527 5.527 0 01-1.01-1.281zm12.228-12c0-.278.132-.417.396-.417h5.312c.57 0 1.112.09 1.625.27.514.174.966.42 1.355.74.388.32.694.702.916 1.146.23.445.344.934.344 1.469v.896c0 .284-.045.562-.136.833-.083.27-.197.52-.343.75-.14.23-.302.43-.49.604-.18.174-.371.306-.573.396.271.097.532.24.782.427.25.188.472.417.666.688.195.27.35.576.469.916.118.34.177.705.177 1.094v.865a3.46 3.46 0 01-.333 1.51c-.222.458-.521.854-.896 1.188-.375.333-.81.593-1.302.78a4.359 4.359 0 01-1.563.282h-6.01c-.264 0-.396-.139-.396-.417V2.563zm2.875 8.083v3.76h3.073c.25 0 .476-.041.677-.125.201-.09.372-.208.51-.354.146-.146.257-.312.334-.5.076-.187.114-.385.114-.594v-.656a1.44 1.44 0 00-1.031-1.438 1.77 1.77 0 00-.562-.093h-3.115zm0-5.906v3.52h2.646c.187 0 .371-.024.552-.072a1.42 1.42 0 00.49-.25c.145-.112.26-.257.343-.438.09-.18.136-.396.136-.646v-.656c0-.257-.045-.476-.136-.656a1.31 1.31 0 00-.354-.459 1.339 1.339 0 00-.48-.26 1.833 1.833 0 00-.54-.083h-2.657zm9.533 4.677c0-.792.142-1.521.427-2.188A5.128 5.128 0 0164.525 5.5c.5-.486 1.09-.865 1.77-1.135a5.999 5.999 0 012.22-.407c.36 0 .735.049 1.124.146.39.09.768.233 1.136.427.368.195.715.445 1.041.75.327.306.611.67.855 1.094.25.424.447.913.593 1.469.146.548.22 1.166.22 1.854v1.02c0 .32-.077.539-.23.657-.146.118-.375.174-.688.167h-6.833v.323c0 .437.07.833.208 1.187.14.347.33.646.573.896.243.25.528.44.855.573.333.132.694.198 1.083.198s.757-.08 1.104-.24c.347-.16.656-.434.927-.823.07-.097.139-.15.208-.156a.27.27 0 01.198.031l1.792.938a.26.26 0 01.104.187c.014.077-.017.177-.094.302a5.03 5.03 0 01-.729.917 4.798 4.798 0 01-.948.75 4.622 4.622 0 01-1.166.5 4.618 4.618 0 01-1.334.188 5.917 5.917 0 01-2.208-.407 5.429 5.429 0 01-1.77-1.125 5.313 5.313 0 01-1.188-1.708 5.408 5.408 0 01-.427-2.167v-2.49zm2.812.01h5.115v-.062c0-.32-.042-.646-.125-.98a2.594 2.594 0 00-.396-.906 2.113 2.113 0 00-.73-.667c-.305-.18-.687-.27-1.145-.27-.445 0-.837.08-1.177.24-.334.159-.615.37-.844.635-.23.257-.403.555-.52.896a3.036 3.036 0 00-.178 1.02v.094zm9.629-.052c0-.764.132-1.476.396-2.135a5.4 5.4 0 011.083-1.72 5.017 5.017 0 013.677-1.563c.361.001.698.053 1.01.158.32.104.615.25.886.437.278.18.528.4.75.656.23.257.434.535.615.834l.218-1.375c.056-.285.233-.427.532-.427h1.354c.278 0 .416.142.416.427v11.906a.437.437 0 01-.114.323.394.394 0 01-.292.104h-1.406a.514.514 0 01-.323-.104.503.503 0 01-.167-.323l-.198-1.386c-.18.306-.385.59-.614.855-.222.257-.472.479-.75.666-.27.188-.57.334-.896.438-.32.11-.66.166-1.02.166-.73 0-1.41-.138-2.042-.416a5.197 5.197 0 01-1.636-1.136 5.428 5.428 0 01-1.083-1.708 5.668 5.668 0 01-.396-2.125V9.375zm2.813 2.604c0 .396.066.76.197 1.094.132.333.313.621.542.864.23.244.5.434.813.573.319.14.663.209 1.03.209a2.78 2.78 0 001.907-.74 2.73 2.73 0 00.583-.833 2.61 2.61 0 00.25-1.042V9.177a2.633 2.633 0 00-.25-1.052 2.73 2.73 0 00-.583-.833 2.623 2.623 0 00-.854-.552 2.78 2.78 0 00-1.052-.198 2.427 2.427 0 00-1.844.792c-.23.242-.41.53-.542.864a2.947 2.947 0 00-.198 1.094v2.687zm11.39-7.312c0-.285.136-.427.406-.427h1.417c.139 0 .26.034.365.104.11.062.187.194.229.396l.219 1.28c.16-.277.34-.54.541-.79.202-.25.43-.47.688-.657.257-.188.538-.337.843-.448a2.938 2.938 0 011.01-.167c.313 0 .605.028.876.084.27.048.517.114.74.198.222.076.413.16.572.25.16.083.288.16.386.229.146.11.229.232.25.364.02.125.01.247-.031.365l-.428 1.656a.318.318 0 01-.114.156.459.459 0 01-.188.084c-.07.007-.142.007-.218 0a.459.459 0 01-.188-.084 5.499 5.499 0 00-.437-.302 2.473 2.473 0 00-.959-.364 3.51 3.51 0 00-.635-.052c-.32 0-.625.052-.917.156a2.222 2.222 0 00-.781.48 2.449 2.449 0 00-.542.812c-.132.326-.198.711-.198 1.156v7.427a.4.4 0 01-.135.323.53.53 0 01-.333.104H89.97c-.27 0-.406-.142-.406-.427V4.667z"
                                ></path>
                            </svg>
                        </div>

                    </LogoDiv>
                    <ActionDivMobile className="mobile">
                        <Button
                            onClick={() => {
                                openModalSearch();
                                logEvent("click-open_search", {
                                    origin: origin || "search_modal"
                                });
                                this.setState({modalIsOpen: true});
                            }}
                        >
                            <div className={styles.searchBtnIcn}>
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="18"
                                    height="18"
                                    fill="none"
                                    viewBox="0 0 18 18"
                                >
                                    <path
                                        fill="#fff"
                                        d="M12.5 11h-.79l-.28-.27A6.471 6.471 0 0013 6.5 6.5 6.5 0 106.5 13c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L17.49 16l-4.99-5zm-6 0C4.01 11 2 8.99 2 6.5S4.01 2 6.5 2 11 4.01 11 6.5 8.99 11 6.5 11z"
                                    ></path>
                                </svg>
                            </div>

                            {buttonTitle}
                        </Button>
                    </ActionDivMobile>
                    <SearchForm
                        layout="bar"
                        classNameContent="desktop"
                        onSubmit={onSubmit}
                        buttonTitle={buttonTitle}
                        setKeyword={setKeyword}
                        getKeyword={getKeyword}
                        keyword={keyword}
                        getLocation={getLocation}
                        app={app}
                    />
                </HeaderDiv>
                <SearchModal
                    isOpen={this.state.modalIsOpen}
                    onSubmit={onSubmit}
                    onRequestClose={() => {
                        this.setState({modalIsOpen: false});
                    }}
                    buttonTitle={buttonTitle}
                    setKeyword={setKeyword}
                    origin={origin}
                    getKeyword={getKeyword}
                    keyword={keyword}
                    getLocation={getLocation}
                    app={app}
                />
            </React.Fragment>
        );
    }
}

export default Header;
